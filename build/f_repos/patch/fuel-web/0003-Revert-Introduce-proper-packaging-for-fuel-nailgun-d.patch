From: Alexandru Avadanii <Alexandru.Avadanii@enea.com>
Date: Sun, 26 Mar 2017 19:28:09 +0200
Subject: [PATCH] Revert "Introduce proper packaging for fuel-nailgun deb
 package"

This reverts commit 746fae6e0a6b6625da6f548f0d168c742497b558.
---
 debian/control                         | 84 ++++------------------------------
 debian/copyright                       | 28 ------------
 debian/docs                            |  1 -
 debian/fencing-agent.dirs              |  2 -
 debian/fencing-agent.install           |  3 +-
 debian/fuel-nailgun.dirs               |  4 --
 debian/fuel-nailgun.install            |  2 -
 debian/fuel-openstack-metadata.dirs    |  2 -
 debian/fuel-openstack-metadata.install |  2 -
 debian/openstack-version               | 12 -----
 debian/rules                           | 45 +++---------------
 11 files changed, 16 insertions(+), 169 deletions(-)
 delete mode 100644 debian/copyright
 delete mode 100644 debian/docs
 delete mode 100644 debian/fencing-agent.dirs
 delete mode 100644 debian/fuel-nailgun.dirs
 delete mode 100644 debian/fuel-nailgun.install
 delete mode 100644 debian/fuel-openstack-metadata.dirs
 delete mode 100644 debian/fuel-openstack-metadata.install
 delete mode 100755 debian/openstack-version

diff --git a/debian/control b/debian/control
index b44b87a..e2a08a9 100644
--- a/debian/control
+++ b/debian/control
@@ -1,80 +1,11 @@
 Source: fuel-nailgun
-Section: python
-Priority: optional
-Maintainer: Mirantis <product@mirantis.com>
-Build-Depends: debhelper (>= 9),
-               dh-python,
-               dh-systemd,
-               openstack-pkg-tools,
-               python-all,
-               python-setuptools (>= 16.0),
-               python-pbr (>= 1.8),
-               python-yaml (>= 3.1.0),
-               git,
-Standards-Version: 3.9.4
-Homepage: https://launchpad.net/fuel
-
-Package: fuel-nailgun
-Architecture: all
-Depends: fuel-openstack-metadata,
-         python-alembic (>= 0.8.4),
-         python-amqplib (>= 1.0.2),
-         python-anyjson (>= 0.3.3),
-         python-babel (>= 2.3.4),
-         python-crypto (>= 2.6.1),
-         python-decorator (>= 3.4.0),
-         python-fysom (>= 1.0.11),
-         python-iso8601 (>= 0.1.11),
-         python-jinja2 (>= 2.8),
-         python-jsonschema (>= 2.3.0),
-         python-keystoneclient (>= 1.7.0),
-         python-keystonemiddleware (>= 4.0.0),
-         python-kombu (>= 3.0.25),
-         python-mako (>= 0.9.1),
-         python-markupsafe (>= 0.18),
-         python-migrate (>= 0.9.6),
-         python-netaddr (>= 0.7.12),
-         python-netifaces (>= 0.10.4),
-         python-oslo-config (>= 1:1.2.1),
-         python-oslo-serialization (>= 1.0.0),
-         python-oslo-db (>= 1.0.0),
-         python-paste (>= 1.7.5.1),
-         python-ply (>= 3.4),
-         python-psycopg2 (>= 2.5.1),
-         python-requests (>= 2.10.0),
-         python-simplejson (>= 3.3.0),
-         python-six (>= 1.9.0),
-         python-sqlalchemy (>= 1.0.10),
-         python-stevedore (>= 1.10.0),
-         python-urllib3 (>= 1.15.1),
-         python-webpy (>= 0.37),
-         python-wsgilog (>= 0.3),
-         python-yaml (>= 3.10),
-         python-novaclient (>= 2.29.0),
-         python-networkx (>= 1.8),
-         python-cinderclient (>= 1.6.0),
-         python-pydot-ng (>= 1.0.0),
-         python-uwsgidecorators (>= 2.0.12),
-         python-yaql (>= 1.1.0),
-         python-tz (>= 2013.6),
-         ${python:Depends},
-         ${misc:Depends}
-Description: fuel-web (nailgun) implements REST API and deployment data management.
- It manages disk volumes configuration data, networks configuration data
- and any other environment specific data which are necessary for successful deployment.
- It has required orchestration logic to build instructions for provisioning
- and deployment in a right order. Nailgun uses SQL database to store its data
- and AMQP service to interact with workers.
-
-Package: fuel-openstack-metadata
-Architecture: all
-Depends: ${misc:Depends}
-Description: fuel-web (nailgun) implements REST API and deployment data management.
- It manages disk volumes configuration data, networks configuration data
- and any other environment specific data which are necessary for successful deployment.
- It has required orchestration logic to build instructions for provisioning
- and deployment in a right order. Nailgun uses SQL database to store its data
- and AMQP service to interact with workers.
+Section: unknown
+Priority: net
+Maintainer: Mirantis Producta <product@mirantis.com>
+Build-Depends: debhelper (>= 8.0.0), python-setuptools
+X-Python-Version: 2.6, 2.7
+Standards-Version: 3.9.2
+Homepage: mirantis.com

 Package: fencing-agent
 Architecture: all
@@ -85,3 +16,4 @@ Depends: ohai,
   ruby-json,
   ${misc:Depends}
 Description: Fencing agent
+ .
diff --git a/debian/copyright b/debian/copyright
deleted file mode 100644
index 8f21453..0000000
--- a/debian/copyright
+++ /dev/null
@@ -1,28 +0,0 @@
-Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
-Upstream-Name: fuel-web
-Source: https://github.com/openstack/fuel-web.git
-
-Files: *
-Copyright: (c) 2016, Mirantis, Inc.
-License: Apache-2
-
-Files: debian/*
-Copyright: (c) 2016, Mirantis, Inc.
-License: Apache-2
-
-License: Apache-2
- Licensed under the Apache License, Version 2.0 (the "License");
- you may not use this file except in compliance with the License.
- You may obtain a copy of the License at
- .
-    http://www.apache.org/licenses/LICENSE-2.0
- .
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
- .
- On Debian-based systems the full text of the Apache version 2.0 license
- can be found in `/usr/share/common-licenses/Apache-2.0'.
-
diff --git a/debian/docs b/debian/docs
deleted file mode 100644
index b43bf86..0000000
--- a/debian/docs
+++ /dev/null
@@ -1 +0,0 @@
-README.md
diff --git a/debian/fencing-agent.dirs b/debian/fencing-agent.dirs
deleted file mode 100644
index b23cc24..0000000
--- a/debian/fencing-agent.dirs
+++ /dev/null
@@ -1,2 +0,0 @@
-opt/nailgun/bin
-etc/cron.d
diff --git a/debian/fencing-agent.install b/debian/fencing-agent.install
index 713bd04..19e8c47 100644
--- a/debian/fencing-agent.install
+++ b/debian/fencing-agent.install
@@ -1,2 +1 @@
-bin/fencing-agent.rb opt/nailgun/bin
-bin/fencing-agent.cron etc/cron.d
+bin/fencing-agent.rb /opt/nailgun/bin
diff --git a/debian/fuel-nailgun.dirs b/debian/fuel-nailgun.dirs
deleted file mode 100644
index 67d11e4..0000000
--- a/debian/fuel-nailgun.dirs
+++ /dev/null
@@ -1,4 +0,0 @@
-etc/nailgun
-var/log/nailgun
-usr/bin
-usr/share
diff --git a/debian/fuel-nailgun.install b/debian/fuel-nailgun.install
deleted file mode 100644
index ef0bddc..0000000
--- a/debian/fuel-nailgun.install
+++ /dev/null
@@ -1,2 +0,0 @@
-nailgun/nailgun/settings.yaml /etc/nailgun/
-systemd/* /lib/systemd/system/
diff --git a/debian/fuel-openstack-metadata.dirs b/debian/fuel-openstack-metadata.dirs
deleted file mode 100644
index 7a41f21..0000000
--- a/debian/fuel-openstack-metadata.dirs
+++ /dev/null
@@ -1,2 +0,0 @@
-usr/share/fuel-openstack-metadata
-etc
diff --git a/debian/fuel-openstack-metadata.install b/debian/fuel-openstack-metadata.install
deleted file mode 100644
index 5c955f5..0000000
--- a/debian/fuel-openstack-metadata.install
+++ /dev/null
@@ -1,2 +0,0 @@
-nailgun/nailgun/fixtures/openstack.yaml usr/share/fuel-openstack-metadata
-fuel_openstack_version etc
diff --git a/debian/openstack-version b/debian/openstack-version
deleted file mode 100755
index 07f857f..0000000
--- a/debian/openstack-version
+++ /dev/null
@@ -1,12 +0,0 @@
-#! /usr/bin/env python2
-
-import sys
-import yaml
-
-if len(sys.argv) == 2:
-    openstack_yaml = open(sys.argv[1])
-    yaml = yaml.safe_load(openstack_yaml)
-    elems = filter(lambda r: r['fields'].get('name'), yaml)
-    print elems[0]['fields']['version']
-else:
-    print """Usage: {} OPENSTACK_YAML""".format(sys.argv[0])
diff --git a/debian/rules b/debian/rules
index c4d7e8e..9731207 100755
--- a/debian/rules
+++ b/debian/rules
@@ -1,46 +1,15 @@
 #!/usr/bin/make -f
-# -*- makefile -*-
-
 DH_VERBOSE=1

-PYTHONS:=$(shell pyversions -vr)
-
-include /usr/share/openstack-pkg-tools/pkgos.make
-
-#export OSLO_PACKAGE_VERSION=$(shell dpkg-parsechangelog | grep Version: | cut -d' ' -f2 | sed -e 's/^[[:digit:]]*://' -e 's/[-].*//' -e 's/~/.0/' | head -n 1)
+topdir=$(shell pwd)

 %:
-	dh $@ --with python2,systemd
+	dh $@ --with python2

+override_dh_auto_install:
+	dh_auto_install
 override_dh_auto_build:
+	dh_clean
 	dh_auto_build
-	python $(CURDIR)/debian/openstack-version nailgun/nailgun/fixtures/openstack.yaml > $(CURDIR)/fuel_openstack_version
-
-override_dh_auto_install:
-	cd nailgun \
-	set -e ; for pyvers in $(PYTHONS); do \
-		python$$pyvers setup.py install --install-layout=deb \
-			--root $(CURDIR)/debian/fuel-nailgun; \
-	done
-
-override_dh_clean:
-	rm -rf  build
-	dh_clean -O--buildsystem=python_distutils
-	rm -f debian/nailgun-common.postinst
-	rm -f debian/*.service debian/*.init debian/*.upstart
-
-override_dh_systemd_enable: gen-init-configurations
-	dh_systemd_enable --no-enable
-
-override_dh_systemd_start: gen-init-configurations
-	dh_systemd_start --no-start
-
-# Commands not to run
-override_dh_installcatalogs:
-override_dh_installemacsen override_dh_installifupdown:
-override_dh_installinfo override_dh_installmenu override_dh_installmime:
-override_dh_installmodules override_dh_installlogcheck:
-override_dh_installpam override_dh_installppp override_dh_installudev override_dh_installwm:
-override_dh_installxfonts override_dh_gconf override_dh_icons override_dh_perl override_dh_usrlocal:
-override_dh_installcron override_dh_installdebconf:
-override_dh_installlogrotate override_dh_installgsettings:
+override_dh_auto_clean:
+	dh_auto_clean
